!function(t){"object"==typeof module&&"object"==typeof module.exports?t(require("jquery"),window,document):t(jQuery,window,document)}(function(P,M,R){"use strict";var D=P("<div/>").attr("class","imagelightbox-loading").append(P("<div/>")),t=P("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-left"}),e=P("<button/>",{type:"button",class:"imagelightbox-arrow imagelightbox-arrow-right"}),z=t.add(e),X=P("<div/>",{class:"imagelightbox-caption",html:"&nbsp;"}),j=P("<button/>",{type:"button",class:"imagelightbox-close"}),N=P("<div/>",{class:"imagelightbox-overlay"}),U=P("<a/>",{href:"#",class:"imagelightbox-navitem"}),V=P("<div/>",{class:"imagelightbox-nav"}),K=P("<div/>",{class:"imagelightbox-wrapper"}),Y=P("body"),o=function(){var t=R.body||R.documentElement;return""===(t=t.style).WebkitTransition?"-webkit-":""===t.MozTransition?"-moz-":""===t.OTransition?"-o-":""===t.transition&&""},_=!1!==o(),H=function(t,e,i){var n={},a=o();n[a+"transform"]="translateX("+e+") translateY(-50%)",n[a+"transition"]=a+"transform "+i+"s linear",t.css(n)},i="ontouchstart"in M,W=M.navigator.pointerEnabled||M.navigator.msPointerEnabled,$=function(t){if(i)return!0;if(!W||void 0===t||void 0===t.pointerType)return!1;if(void 0!==t.MSPOINTER_TYPE_MOUSE){if(t.MSPOINTER_TYPE_MOUSE!==t.pointerType)return!0}else if("mouse"!==t.pointerType)return!0;return!1},B=!1!=!!(R.fullscreenEnabled||R.webkitFullscreenEnabled||R.mozFullScreenEnabled||R.msFullscreenEnabled),Q=!(!M.history||!history.pushState);P.fn.imageLightbox=function(t){var i="",s=P([]),u=P(),d=P([]),r=-1,g=0,c=0,f=0,n=0,p=P.extend({selector:"a[data-imagelightbox]",id:"imagelightbox",allowedTypes:"png|jpg|jpeg|gif",animationSpeed:250,activity:!1,arrows:!1,button:!1,caption:!1,enableKeyboard:!0,history:!1,fullscreen:!1,gutter:10,offsetY:0,navigation:!1,overlay:!1,preloadNext:!0,quitOnEnd:!1,quitOnImgClick:!1,quitOnDocClick:!0,quitOnEscKey:!0},t),h=function(){p.activity&&y(),p.arrows&&z.css("display","block")},a=function(t,e,i){var n=e+"="+i,a="?"+n;if(t){var o=new RegExp("([?&])"+e+"=[^&]*");a=null!==t.match(o)?t.replace(o,"$1"+n):t+"&"+n}return a},o=function(){if(Q&&p.history){var t=s[r].dataset.ilb2Id;t||(t=r);var e={imageLightboxIndex:t},i=s[r].dataset.imagelightbox;i&&(e.imageLightboxSet=i);var n=a(R.location.search,"imageLightboxIndex",t);i&&(n=a(n,"imageLightboxSet",i)),M.history.pushState(e,"",R.location.pathname+n)}},e=function(t,e){var i=t;if(i){var n=new RegExp("[?]"+e+"=[^&]*"),a=new RegExp("&"+e+"=[^&]*");i=(i=i.replace(n,"?")).replace(a,"")}return i},l=function(t){var e=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(R.location.search);if(e&&e[2])return decodeURIComponent(e[2].replace(/\+/g," "))},b=function(){if(Q&&p.history){var t=l("imageLightboxIndex");if(t){var e=s.filter('[data-ilb2-id="'+t+'"]');0<e.length?r=s.index(e):e=P(s[r=t]);var i=l("imageLightboxSet");!e[0]||i&&i!==e[0].dataset.imagelightbox||T(e,!0)}}},m=function(){if(--r<0){if(!0===p.quitOnEnd)return F(),!1;r=s.length-1}u=s.eq(r),o(),K.trigger("previous.ilb2",u),O(1)},v=function(){if(++r>=s.length){if(!0===p.quitOnEnd)return F(),!1;r=0}o(),u=s.eq(r),K.trigger("next.ilb2",u),O(-1)},x=function(){K.append(D)},y=function(){P(".imagelightbox-loading").remove()},w=function(){K.append(N)},E=function(){j.appendTo(K).on("click.ilb7",function(){return F(),!1})},S=function(){X.html("&nbsp;"),P(u).data("ilb2-caption")?X.html(P(u).data("ilb2-caption")):0<P(u).find("img").length&&X.html(P(u).find("img").attr("alt"))},q=function(){if(s.length){for(var t=0;t<s.length;t++)V.append(U.clone());var e=V.children("a");e.eq(s.index(u)).addClass("active"),K.on("previous.ilb2 next.ilb2",function(){e.removeClass("active").eq(s.index(u)).addClass("active")}),K.append(V),V.on("click.ilb7 touchend.ilb7",function(){return!1}).on("click.ilb7 touchend.ilb7","a",function(){var t=P(this);if(s.eq(t.index()).attr("href")!==P(".imagelightbox").attr("src")){var e=s.eq(t.index());e.length&&(n=s.index(u),u=e,O(t.index()<n?-1:1))}t.addClass("active").siblings().removeClass("active")})}},I=function(){K.append(z),z.on("click.ilb7 touchend.ilb7",function(t){return t.stopImmediatePropagation(),t.preventDefault(),P(this).hasClass("imagelightbox-arrow-left")?m():v(),!1})},k=function(t){var e=p.caption?X.outerHeight():0,o=P(M).width(),r=P(M).height()-e,l=Math.abs(1-p.gutter/100);function i(t){if(o<g||r<c){var e=o/r<g/c?g/o:c/r;g/=e,c/=e}var i=c*l,n=g*l,a=(P(M).width()-n)/2;t.css({width:n+"px",height:i+"px",left:a+"px"})}if(void 0!==t.get(0).videoWidth)return g=t.get(0).videoWidth,c=t.get(0).videoHeight,void i(t);var n=new Image;n.onload=function(){g=n.width,c=n.height,i(t)},n.src=t.attr("src")},O=function(c,t){if(t.length&&t[0].complete){var e={opacity:0};_?H(t,100*c-f+"px",p.animationSpeed/1e3):e.left=parseInt(t.css("left"))+100*c+"px",t.animate(e,p.animationSpeed,function(){C()}),f=0}p.activity&&x(),p.caption&&S(),setTimeout(function(){var t,e,i=u.attr("href"),n=0,a=0,o=0;function r(t){var e={opacity:1};if((l=P(t.currentTarget)).appendTo(K),k(l),l.css("opacity",0),_)H(l,-100*c+"px",0),setTimeout(function(){H(l,"0px",p.animationSpeed/1e3)},50);else{var i=parseInt(l.css("left"));e.left=i+"px",l.css("left",i-100*c+"px")}if(l.animate(e,p.animationSpeed,function(){h()}),p.preloadNext){var n=s.eq(s.index(u)+1);n.length||(n=s.eq(0)),P("<img />").attr("src",n.attr("href"))}K.trigger("loaded.ilb2")}u.data("ilb2Video")?d.each(function(){this.i===u.data("ilb2VideoId")&&(t=this.l,e=this.e,this.a&&(!1===t&&e.attr("autoplay",this.a),!0===t&&e.get(0).play()))}):e=P("<img id='"+p.id+"' />").attr("src",i);var l=e.on("load.ilb7",r).on("error.ilb7",function(){h()}).on(W?"pointerup.ilb7 MSPointerUp.ilb7":"click.ilb7",function(t){return t.preventDefault(),p.quitOnImgClick?(F(),!1):!!$(t.originalEvent)||void((t.pageX||t.originalEvent.pageX)-t.target.offsetLeft<g/2?m():v())}).on("touchstart.ilb7 pointerdown.ilb7 MSPointerDown.ilb7",function(t){if(!$(t.originalEvent)||p.quitOnImgClick)return!0;_&&(o=parseInt(l.css("left"))),n=t.originalEvent.pageX||t.originalEvent.touches[0].pageX}).on("touchmove.ilb7 pointermove.ilb7 MSPointerMove.ilb7",function(t){if(!W&&"pointermove"===t.type||!$(t.originalEvent)||p.quitOnImgClick)return!0;t.preventDefault(),a=t.originalEvent.pageX||t.originalEvent.touches[0].pageX,f=n-a,_?H(l,-f+"px",0):l.css("left",o-f+"px")}).on("touchend.ilb7 touchcancel.ilb7 pointerup.ilb7 pointercancel.ilb7 MSPointerUp.ilb7 MSPointerCancel.ilb7",function(t){if(!$(t.originalEvent)||p.quitOnImgClick)return!0;50<Math.abs(f)?f<0?m():v():_?H(l,"0px",p.animationSpeed/1e3):l.animate({left:o+"px"},p.animationSpeed/2)});P(R).on("quit.ilb2",function(){l.animate({opacity:0},p.animationSpeed,function(){C(l),K.remove().find("*").remove()})}),!0===t&&r(),!1===t&&(l=l.on("loadedmetadata.ilb7",r))},p.animationSpeed+100)},C=function(t){if(!t.length)return!1;t.remove(),t=P()},T=function(t,e){u=t,r=s.index(u),e||o(),function(){p.arrows&&I(this),p.navigation&&q(),p.overlay&&w(),p.button&&E(),p.caption&&K.append(X)}(),Y.append(K).addClass("imagelightbox-open"),K.trigger("start.ilb2",t),O(0,t)},F=function(t){r=-1,t||function(){if(Q&&p.history){var t=e(R.location.search,"imageLightboxIndex");t=e(t,"imageLightboxSet"),M.history.pushState({},"",R.location.pathname+t)}}(),K.trigger("quit.ilb2"),Y.removeClass("imagelightbox-open")},L=function(e){e.each(function(){s=e.add(P(this))}),e.on("click.ilb7",{set:i},function(t){t.preventDefault(),i=P(t.currentTarget).data("imagelightbox"),e.filter(function(){return P(this).data("imagelightbox")===i}).filter(function(){return t=P(this),"a"===P(t).prop("tagName").toLowerCase()&&(new RegExp(".("+p.allowedTypes+")$","i").test(P(t).attr("href"))||P(t).data("ilb2Video"));var t}).each(function(){s=s.add(P(this))}),s.length<1?F():T(P(this))})};return P(M).on("resize.ilb7",k),Q&&p.history&&P(M).on("popstate",function(t){var e=t.originalEvent.state;if(e){var i=e.imageLightboxIndex;if(void 0!==i){var n=s.filter('[data-ilb2-id="'+i+'"]');if(0<n.length)var a=s.index(n);else n=P(s[a=i]);if(n[0]&&(!e.imageLightboxSet||e.imageLightboxSet===n[0].dataset.imagelightbox))if(r<0)T(n,!0);else{var o=1;r<a&&(o=-1),u=n,r=a,O(o)}}else F(!0)}else F(!0)}),P(R).ready(function(){p.fullscreen&&B&&P(R).on("keydown.ilb7",function(t){var e;-1<[9,32,38,40].indexOf(t.which)&&(t.stopPropagation(),t.preventDefault()),-1<[13].indexOf(t.which)&&(t.stopPropagation(),t.preventDefault(),(e=R.getElementById(p.id).parentElement).requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen(),R.exitFullscreen?R.exitFullscreen():R.mozCancelFullScreen?R.mozCancelFullScreen():R.webkitExitFullscreen&&R.webkitExitFullscreen())}),p.enableKeyboard&&P(R).on("keydown.ilb7",function(t){-1<[27].indexOf(t.which)&&p.quitOnEscKey&&(t.stopPropagation(),t.preventDefault(),F()),-1<[37].indexOf(t.which)&&(t.stopPropagation(),t.preventDefault(),m()),-1<[39].indexOf(t.which)&&(t.stopPropagation(),t.preventDefault(),v())})}),P(R).off("click",p.selector),L(P(this)),b(),s.each(function(){var t=P(this).data("ilb2Video");if(t){var e=P(this).data("ilb2Id");e||(e="a"+(65536*(1+Math.random())|0).toString(16)),P(this).data("ilb2VideoId",e);var n={e:P("<video id='"+p.id+"' preload='metadata'>"),i:e,l:!1,a:void 0};P.each(t,function(t,e){"autoplay"===t?n.a=e:"sources"!==t&&(n.e=n.e.attr(t,e))}),t.sources&&P.each(t.sources,function(t,e){var i=P("<source>");P.each(e,function(t,e){i=i.attr(t,e)}),n.e.append(i)}),n.e.on("loadedmetadata.ilb7",function(){n.l=!0}),d=d.add(n)}}),this.addToImageLightbox=function(t){L(t)},this.openHistory=function(){b()},this.loadPreviousImage=function(){m()},this.loadNextImage=function(){v()},this.quitImageLightbox=function(){return F(),this},this.startImageLightbox=function(t){t?t.trigger("click.ilb7"):P(this).trigger("click.ilb7")},this}});